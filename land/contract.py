from email.headerregistry import Address
from web3 import Web3, contract
import json


ganache_url = "http://127.0.0.1:7545"
web3 = Web3(Web3.HTTPProvider(ganache_url))
web3.eth.defaultAccount = '0xB7dbfc47109CC0529780AF0124ADD5C84d10535E'
contract_address = "0xf2a11139169f67e2e5250c734C432e48487bDC75"
print(web3.isConnected())


abi = json.loads('[{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"constant":false,"inputs":[{"internalType":"string","name":"_UUID","type":"string"},{"internalType":"uint256","name":"_surveyNumber","type":"uint256"},{"internalType":"address payable","name":"_OwnerAddress","type":"address"},{"internalType":"string","name":"_ownerID","type":"string"},{"internalType":"string","name":"_hashKey","type":"string"},{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"_district","type":"string"}],"name":"Registration","outputs":[{"internalType":"bool","name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"_superAdmin","type":"address"},{"internalType":"string","name":"_district","type":"string"}],"name":"addSuperAdmin","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"landInfoOwner","outputs":[{"internalType":"string","name":"","type":"string"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"string","name":"","type":"string"},{"internalType":"string","name":"","type":"string"},{"internalType":"string","name":"","type":"string"},{"internalType":"address","name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"OwnerAddress","type":"address"},{"internalType":"string","name":"_district","type":"string"}],"name":"viewAllAssets","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"viewAssets","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"payable":false,"stateMutability":"view","type":"function"}]')

bytecode = "608060405234801561001057600080fd5b5061237c806100206000396000f3fe60806040526004361061007b5760003560e01c806371ad72211161004e57806371ad722114610151578063982feeea14610192578063b07048d9146101bb578063c75d70ed146101d75761007b565b80631f1439241461008057806345a813de146100a95780634eeeae08146100ea5780636243554114610113575b600080fd5b34801561008c57600080fd5b506100a760048036038101906100a29190611b00565b610202565b005b3480156100b557600080fd5b506100d060048036038101906100cb9190611aae565b610345565b6040516100e1959493929190612064565b60405180910390f35b3480156100f657600080fd5b50610111600480360381019061010c9190611d2b565b6107d5565b005b34801561011f57600080fd5b5061013a60048036038101906101359190611cea565b610931565b604051610148929190612012565b60405180910390f35b34801561015d57600080fd5b5061017860048036038101906101739190611aae565b610a05565b6040516101899594939291906120d3565b60405180910390f35b34801561019e57600080fd5b506101b960048036038101906101b49190611be9565b610f5a565b005b6101d560048036038101906101d09190611ad7565b6110b0565b005b3480156101e357600080fd5b506101ec6114f1565b6040516101f99190612042565b60405180910390f35b60006040518060c001604052808873ffffffffffffffffffffffffffffffffffffffff168152602001878152602001868152602001858152602001848152602001838152509050600381908060018154018082558091505060019003906000526020600020906006020160009091909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010190805190602001906102d8929190611838565b5060408201518160020190805190602001906102f5929190611838565b506060820151816003019080519060200190610312929190611838565b50608082015181600401908051906020019061032f929190611838565b5060a08201518160050155505050505050505050565b606080606080600080600090505b6003805490508110156106e25760006003828154811061036f57fe5b90600052602060002090600602016040518060c00160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104775780601f1061044c57610100808354040283529160200191610477565b820191906000526020600020905b81548152906001019060200180831161045a57829003601f168201915b50505050508152602001600282018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156105195780601f106104ee57610100808354040283529160200191610519565b820191906000526020600020905b8154815290600101906020018083116104fc57829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156105bb5780601f10610590576101008083540402835291602001916105bb565b820191906000526020600020905b81548152906001019060200180831161059e57829003601f168201915b50505050508152602001600482018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561065d5780601f106106325761010080835404028352916020019161065d565b820191906000526020600020905b81548152906001019060200180831161064057829003601f168201915b5050505050815260200160058201548152505090508773ffffffffffffffffffffffffffffffffffffffff16816000015173ffffffffffffffffffffffffffffffffffffffff1614156106d45780602001518160400151826060015183608001518460a001519650965096509650965050506107cc565b508080600101915050610353565b60006040518060400160405280600981526020017f4e6f7420466f756e640000000000000000000000000000000000000000000000815250906040518060400160405280600981526020017f4e6f7420466f756e640000000000000000000000000000000000000000000000815250906040518060400160405280600981526020017f4e6f7420466f756e640000000000000000000000000000000000000000000000815250906040518060400160405280600981526020017f4e6f7420466f756e6400000000000000000000000000000000000000000000008152509095509550955095509550505b91939590929450565b600080836040516107e69190611ffb565b908152602001604051809103902080549050141561086b5760405180602001604052808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152506000836040516108499190611ffb565b90815260200160405180910390209060016108659291906118c6565b5061092d565b60008260405161087b9190611ffb565b90815260200160405180910390206001908054610899929190611950565b506001819080600181540180825580915050600190039060005260206000200160009091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160008360405161090f9190611ffb565b908152602001604051809103902090805461092b929190611950565b505b5050565b6060600080836040516109449190611ffb565b90815260200160405180910390206000846040516109629190611ffb565b908152602001604051809103902080549050818054806020026020016040519081016040528092919081815260200182805480156109f557602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190600101908083116109ab575b5050505050915091509150915091565b606080606080606060005b600280549050811015610e3757600060028281548110610a2c57fe5b90600052602060002090600602016040518060c00160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610b345780601f10610b0957610100808354040283529160200191610b34565b820191906000526020600020905b815481529060010190602001808311610b1757829003601f168201915b50505050508152602001600282018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610bd65780601f10610bab57610100808354040283529160200191610bd6565b820191906000526020600020905b815481529060010190602001808311610bb957829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c785780601f10610c4d57610100808354040283529160200191610c78565b820191906000526020600020905b815481529060010190602001808311610c5b57829003601f168201915b50505050508152602001600482018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610d1a5780601f10610cef57610100808354040283529160200191610d1a565b820191906000526020600020905b815481529060010190602001808311610cfd57829003601f168201915b50505050508152602001600582018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610dbc5780601f10610d9157610100808354040283529160200191610dbc565b820191906000526020600020905b815481529060010190602001808311610d9f57829003601f168201915b50505050508152505090508773ffffffffffffffffffffffffffffffffffffffff16816000015173ffffffffffffffffffffffffffffffffffffffff161415610e295780602001518160400151826060015183608001518460a00151965096509650965096505050610f51565b508080600101915050610a10565b6040518060400160405280600981526020017f4e6f7420466f756e6400000000000000000000000000000000000000000000008152506040518060400160405280600981526020017f4e6f7420466f756e6400000000000000000000000000000000000000000000008152506040518060400160405280600981526020017f4e6f7420466f756e6400000000000000000000000000000000000000000000008152506040518060400160405280600981526020017f4e6f7420466f756e6400000000000000000000000000000000000000000000008152506040518060400160405280600981526020017f4e6f7420466f756e64000000000000000000000000000000000000000000000081525095509550955095509550505b91939590929450565b60006040518060c001604052808873ffffffffffffffffffffffffffffffffffffffff168152602001878152602001868152602001858152602001848152602001838152509050600281908060018154018082558091505060019003906000526020600020906006020160009091909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506020820151816001019080519060200190611030929190611838565b50604082015181600201908051906020019061104d929190611838565b50606082015181600301908051906020019061106a929190611838565b506080820151816004019080519060200190611087929190611838565b5060a08201518160050190805190602001906110a4929190611838565b50505050505050505050565b8073ffffffffffffffffffffffffffffffffffffffff166108fc349081150290604051600060405180830381858888f193505050501580156110f6573d6000803e3d6000fd5b5060005b6003805490508110156114ed5760006003828154811061111657fe5b90600052602060002090600602016040518060c00160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561121e5780601f106111f35761010080835404028352916020019161121e565b820191906000526020600020905b81548152906001019060200180831161120157829003601f168201915b50505050508152602001600282018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156112c05780601f10611295576101008083540402835291602001916112c0565b820191906000526020600020905b8154815290600101906020018083116112a357829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156113625780601f1061133757610100808354040283529160200191611362565b820191906000526020600020905b81548152906001019060200180831161134557829003601f168201915b50505050508152602001600482018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156114045780601f106113d957610100808354040283529160200191611404565b820191906000526020600020905b8154815290600101906020018083116113e757829003601f168201915b5050505050815260200160058201548152505090508273ffffffffffffffffffffffffffffffffffffffff16816000015173ffffffffffffffffffffffffffffffffffffffff1614156114df576003828154811061145e57fe5b9060005260206000209060060201600080820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001820160006114a491906119a2565b6002820160006114b491906119a2565b6003820160006114c491906119a2565b6004820160006114d491906119a2565b600582016000905550505b5080806001019150506110fa565b5050565b60606003805480602002602001604051908101604052809291908181526020016000905b8282101561182f57838290600052602060002090600602016040518060c00160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156116275780601f106115fc57610100808354040283529160200191611627565b820191906000526020600020905b81548152906001019060200180831161160a57829003601f168201915b50505050508152602001600282018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156116c95780601f1061169e576101008083540402835291602001916116c9565b820191906000526020600020905b8154815290600101906020018083116116ac57829003601f168201915b50505050508152602001600382018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561176b5780601f106117405761010080835404028352916020019161176b565b820191906000526020600020905b81548152906001019060200180831161174e57829003601f168201915b50505050508152602001600482018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561180d5780601f106117e25761010080835404028352916020019161180d565b820191906000526020600020905b8154815290600101906020018083116117f057829003601f168201915b5050505050815260200160058201548152505081526020019060010190611515565b50505050905090565b828054600181600116156101000203166002900490600052602060002090601f01602090048101928261186e57600085556118b5565b82601f1061188757805160ff19168380011785556118b5565b828001600101855582156118b5579182015b828111156118b4578251825591602001919060010190611899565b5b5090506118c291906119ea565b5090565b82805482825590600052602060002090810192821561193f579160200282015b8281111561193e5782518260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550916020019190600101906118e6565b5b50905061194c91906119ea565b5090565b8280548282559060005260206000209081019282156119915760005260206000209182015b82811115611990578254825591600101919060010190611975565b5b50905061199e91906119ea565b5090565b50805460018160011615610100020316600290046000825580601f106119c857506119e7565b601f0160209004906000526020600020908101906119e691906119ea565b5b50565b5b80821115611a035760008160009055506001016119eb565b5090565b6000611a1a611a158461217a565b612149565b905082815260208101848484011115611a3257600080fd5b611a3d8482856122ac565b509392505050565b600081359050611a5481612301565b92915050565b600081359050611a6981612318565b92915050565b600081359050611a7e8161232f565b92915050565b600082601f830112611a9557600080fd5b8135611aa5848260208601611a07565b91505092915050565b600060208284031215611ac057600080fd5b6000611ace84828501611a45565b91505092915050565b600060208284031215611ae957600080fd5b6000611af784828501611a5a565b91505092915050565b60008060008060008060c08789031215611b1957600080fd5b6000611b2789828a01611a45565b965050602087013567ffffffffffffffff811115611b4457600080fd5b611b5089828a01611a84565b955050604087013567ffffffffffffffff811115611b6d57600080fd5b611b7989828a01611a84565b945050606087013567ffffffffffffffff811115611b9657600080fd5b611ba289828a01611a84565b935050608087013567ffffffffffffffff811115611bbf57600080fd5b611bcb89828a01611a84565b92505060a0611bdc89828a01611a6f565b9150509295509295509295565b60008060008060008060c08789031215611c0257600080fd5b6000611c1089828a01611a45565b965050602087013567ffffffffffffffff811115611c2d57600080fd5b611c3989828a01611a84565b955050604087013567ffffffffffffffff811115611c5657600080fd5b611c6289828a01611a84565b945050606087013567ffffffffffffffff811115611c7f57600080fd5b611c8b89828a01611a84565b935050608087013567ffffffffffffffff811115611ca857600080fd5b611cb489828a01611a84565b92505060a087013567ffffffffffffffff811115611cd157600080fd5b611cdd89828a01611a84565b9150509295509295509295565b600060208284031215611cfc57600080fd5b600082013567ffffffffffffffff811115611d1657600080fd5b611d2284828501611a84565b91505092915050565b60008060408385031215611d3e57600080fd5b600083013567ffffffffffffffff811115611d5857600080fd5b611d6485828601611a84565b9250506020611d7585828601611a45565b9150509250929050565b6000611d8b8383611dab565b60208301905092915050565b6000611da38383611f4e565b905092915050565b611db481612254565b82525050565b6000611dc5826121ca565b611dcf8185612205565b9350611dda836121aa565b8060005b83811015611e0b578151611df28882611d7f565b9750611dfd836121eb565b925050600181019050611dde565b5085935050505092915050565b6000611e23826121d5565b611e2d8185612216565b935083602082028501611e3f856121ba565b8060005b85811015611e7b5784840389528151611e5c8582611d97565b9450611e67836121f8565b925060208a01995050600181019050611e43565b50829750879550505050505092915050565b611e9681612278565b82525050565b611ea581612278565b82525050565b6000611eb6826121e0565b611ec08185612227565b9350611ed08185602086016122bb565b611ed9816122f0565b840191505092915050565b6000611eef826121e0565b611ef98185612238565b9350611f098185602086016122bb565b611f12816122f0565b840191505092915050565b6000611f28826121e0565b611f328185612249565b9350611f428185602086016122bb565b80840191505092915050565b600060c083016000830151611f666000860182611dab565b5060208301518482036020860152611f7e8282611eab565b91505060408301518482036040860152611f988282611eab565b91505060608301518482036060860152611fb28282611eab565b91505060808301518482036080860152611fcc8282611eab565b91505060a0830151611fe160a0860182611e8d565b508091505092915050565b611ff5816122a2565b82525050565b60006120078284611f1d565b915081905092915050565b6000604082019050818103600083015261202c8185611dba565b905061203b6020830184611fec565b9392505050565b6000602082019050818103600083015261205c8184611e18565b905092915050565b600060a082019050818103600083015261207e8188611ee4565b905081810360208301526120928187611ee4565b905081810360408301526120a68186611ee4565b905081810360608301526120ba8185611ee4565b90506120c96080830184611e9c565b9695505050505050565b600060a08201905081810360008301526120ed8188611ee4565b905081810360208301526121018187611ee4565b905081810360408301526121158186611ee4565b905081810360608301526121298185611ee4565b9050818103608083015261213d8184611ee4565b90509695505050505050565b6000604051905081810181811067ffffffffffffffff821117156121705761216f6122ee565b5b8060405250919050565b600067ffffffffffffffff821115612195576121946122ee565b5b601f19601f8301169050602081019050919050565b6000819050602082019050919050565b6000819050602082019050919050565b600081519050919050565b600081519050919050565b600081519050919050565b6000602082019050919050565b6000602082019050919050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b600081905092915050565b600061225f82612282565b9050919050565b600061227182612282565b9050919050565b6000819050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b82818337600083830152505050565b60005b838110156122d95780820151818401526020810190506122be565b838111156122e8576000848401525b50505050565bfe5b6000601f19601f8301169050919050565b61230a81612254565b811461231557600080fd5b50565b61232181612266565b811461232c57600080fd5b50565b61233881612278565b811461234357600080fd5b5056fea2646970667358221220f5e050195646ea9cb675d6d5a0167c3c94bf0e1c3137380aba411bf09cbd067564736f6c63430007060033",


contract = web3.eth.contract(
    address=contract_address,
    abi=abi
)


def register_asset(UUID, survey_no, owner_address, owner_id, hash_key, land_id, district):
    owner_address = Web3.toChecksumAddress(owner_address)

    tx_hash = contract.functions.Registration(
        UUID, survey_no, owner_address, owner_id, hash_key, land_id, district) .transact()

    tx_receipt = web3.eth.waitForTransactionReceipt(tx_hash)
    return True


def get_asset(id):
    # owner_address = Web3.toChecksumAddress(owner_address)
    # web3.eth.defaultAccount = '0xB7dbfc47109CC0529780AF0124ADD5C84d10535E'
    asset = contract.functions.landInfoOwner(id).call()
    return asset
